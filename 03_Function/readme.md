---
title: 3. å‡½æ•°
tags:
  - solidity
  - basic
  - wtfacademy
---

# WTF Solidityæç®€å…¥é—¨: 3. å‡½æ•°

æˆ‘æœ€è¿‘åœ¨é‡æ–°å­¦solidityï¼Œå·©å›ºä¸€ä¸‹ç»†èŠ‚ï¼Œä¹Ÿå†™ä¸€ä¸ªâ€œWTF Solidityæç®€å…¥é—¨â€ï¼Œä¾›å°ç™½ä»¬ä½¿ç”¨ï¼ˆç¼–ç¨‹å¤§ä½¬å¯ä»¥å¦æ‰¾æ•™ç¨‹ï¼‰ï¼Œæ¯å‘¨æ›´æ–°1-3è®²ã€‚

æ¨ç‰¹ï¼š[@0xAA_Science](https://twitter.com/0xAA_Science)

ç¤¾åŒºï¼š[Discord](https://discord.gg/5akcruXrsk)ï½œ[å¾®ä¿¡ç¾¤](https://docs.google.com/forms/d/e/1FAIpQLSe4KGT8Sh6sJ7hedQRuIYirOoZK_85miz3dw7vA1-YjodgJ-A/viewform?usp=sf_link)ï½œ[å®˜ç½‘ wtf.academy](https://wtf.academy)

æ‰€æœ‰ä»£ç å’Œæ•™ç¨‹å¼€æºåœ¨github: [github.com/AmazingAng/WTFSolidity](https://github.com/AmazingAng/WTFSolidity)

-----

## å‡½æ•°

Solidityè¯­è¨€çš„å‡½æ•°éå¸¸çµæ´»ï¼Œå¯ä»¥è¿›è¡Œå„ç§å¤æ‚æ“ä½œã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šæ¦‚è¿°å‡½æ•°çš„åŸºç¡€æ¦‚å¿µï¼Œå¹¶é€šè¿‡ä¸€äº›ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨å‡½æ•°ã€‚

æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ Solidity ä¸­å‡½æ•°çš„å½¢å¼:

```solidity
function <function name>(<parameter types>) {internal|external|public|private} [pure|view|payable] [returns (<return types>)]
```

çœ‹ç€æœ‰ä¸€äº›å¤æ‚ï¼Œè®©æˆ‘ä»¬ä»å‰å¾€åé€ä¸ªè§£é‡Š(æ–¹æ‹¬å·ä¸­çš„æ˜¯å¯å†™å¯ä¸
å†™çš„å…³é”®å­—)ï¼š

1. `function`ï¼šå£°æ˜å‡½æ•°æ—¶çš„å›ºå®šç”¨æ³•ã€‚è¦ç¼–å†™å‡½æ•°ï¼Œå°±éœ€è¦ä»¥ `function` å…³é”®å­—å¼€å¤´ã€‚

2. `<function name>`ï¼šå‡½æ•°åã€‚

3. `(<parameter types>)`ï¼šåœ†æ‹¬å·å†…å†™å…¥å‡½æ•°çš„å‚æ•°ï¼Œå³è¾“å…¥åˆ°å‡½æ•°çš„å˜é‡ç±»å‹å’Œåç§°ã€‚

4. `{internal|external|public|private}`ï¼šå‡½æ•°å¯è§æ€§è¯´æ˜ç¬¦ï¼Œå…±æœ‰4ç§ã€‚

    - `public`ï¼šå†…éƒ¨å’Œå¤–éƒ¨å‡å¯è§ã€‚
    - `private`ï¼šåªèƒ½ä»æœ¬åˆçº¦å†…éƒ¨è®¿é—®ï¼Œç»§æ‰¿çš„åˆçº¦ä¹Ÿä¸èƒ½ä½¿ç”¨ã€‚
    - `external`ï¼šåªèƒ½ä»åˆçº¦å¤–éƒ¨è®¿é—®ï¼ˆä½†å†…éƒ¨å¯ä»¥é€šè¿‡ `this.f()` æ¥è°ƒç”¨ï¼Œ`f`æ˜¯å‡½æ•°åï¼‰ã€‚
    - `internal`: åªèƒ½ä»åˆçº¦å†…éƒ¨è®¿é—®ï¼Œç»§æ‰¿çš„åˆçº¦å¯ä»¥ç”¨ã€‚

    **æ³¨æ„ 1**ï¼šåˆçº¦ä¸­å®šä¹‰çš„å‡½æ•°éœ€è¦æ˜ç¡®æŒ‡å®šå¯è§æ€§ï¼Œå®ƒä»¬æ²¡æœ‰é»˜è®¤å€¼ã€‚

    **æ³¨æ„ 2**ï¼š`public|private|internal` ä¹Ÿå¯ç”¨äºä¿®é¥°çŠ¶æ€å˜é‡ã€‚`public`å˜é‡ä¼šè‡ªåŠ¨ç”ŸæˆåŒåçš„`getter`å‡½æ•°ï¼Œç”¨äºæŸ¥è¯¢æ•°å€¼ã€‚æœªæ ‡æ˜å¯è§æ€§ç±»å‹çš„çŠ¶æ€å˜é‡ï¼Œé»˜è®¤ä¸º`internal`ã€‚

5. `[pure|view|payable]`ï¼šå†³å®šå‡½æ•°æƒé™/åŠŸèƒ½çš„å…³é”®å­—ã€‚`payable`ï¼ˆå¯æ”¯ä»˜çš„ï¼‰å¾ˆå¥½ç†è§£ï¼Œå¸¦ç€å®ƒçš„å‡½æ•°ï¼Œè¿è¡Œçš„æ—¶å€™å¯ä»¥ç»™åˆçº¦è½¬å…¥ ETHã€‚`pure` å’Œ `view` çš„ä»‹ç»è§ä¸‹ä¸€èŠ‚ã€‚

6. `[returns ()]`ï¼šå‡½æ•°è¿”å›çš„å˜é‡ç±»å‹å’Œåç§°ã€‚

## åˆ°åº•ä»€ä¹ˆæ˜¯ `Pure` å’Œ`View`ï¼Ÿ

åˆšå¼€å§‹å­¦ä¹  `solidity` æ—¶ï¼Œ`pure` å’Œ `view` å…³é”®å­—å¯èƒ½ä»¤äººè´¹è§£ï¼Œå› ä¸ºå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­æ²¡æœ‰ç±»ä¼¼çš„å…³é”®å­—ã€‚`solidity` å¼•å…¥è¿™ä¸¤ä¸ªå…³é”®å­—ä¸»è¦æ˜¯å› ä¸º ä»¥å¤ªåŠäº¤æ˜“éœ€è¦æ”¯ä»˜æ°”è´¹ï¼ˆgas feeï¼‰ã€‚åˆçº¦çš„çŠ¶æ€å˜é‡å­˜å‚¨åœ¨é“¾ä¸Šï¼Œgas fee å¾ˆè´µï¼Œå¦‚æœè®¡ç®—ä¸æ”¹å˜é“¾ä¸ŠçŠ¶æ€ï¼Œå°±å¯ä»¥ä¸ç”¨ä»˜ `gas`ã€‚åŒ…å« `pure` å’Œ `view` å…³é”®å­—çš„å‡½æ•°æ˜¯ä¸æ”¹å†™é“¾ä¸ŠçŠ¶æ€çš„ï¼Œå› æ­¤ç”¨æˆ·ç›´æ¥è°ƒç”¨å®ƒä»¬æ˜¯ä¸éœ€è¦ä»˜ gas çš„ï¼ˆæ³¨æ„ï¼Œåˆçº¦ä¸­é `pure`/`view` å‡½æ•°è°ƒç”¨ `pure`/`view` å‡½æ•°æ—¶éœ€è¦ä»˜gasï¼‰ã€‚

åœ¨ä»¥å¤ªåŠä¸­ï¼Œä»¥ä¸‹è¯­å¥è¢«è§†ä¸ºä¿®æ”¹é“¾ä¸ŠçŠ¶æ€ï¼š

1. å†™å…¥çŠ¶æ€å˜é‡ã€‚
2. é‡Šæ”¾äº‹ä»¶ã€‚
3. åˆ›å»ºå…¶ä»–åˆçº¦ã€‚
4. ä½¿ç”¨ `selfdestruct`.
5. é€šè¿‡è°ƒç”¨å‘é€ä»¥å¤ªå¸ã€‚
6. è°ƒç”¨ä»»ä½•æœªæ ‡è®° `view` æˆ– `pure` çš„å‡½æ•°ã€‚
7. ä½¿ç”¨ä½çº§è°ƒç”¨ï¼ˆlow-level callsï¼‰ã€‚
8. ä½¿ç”¨åŒ…å«æŸäº›æ“ä½œç çš„å†…è”æ±‡ç¼–ã€‚

ä¸ºäº†å¸®åŠ©å¤§å®¶ç†è§£ï¼Œæˆ‘ç”»äº†ä¸€ä¸ªé©¬é‡Œå¥¥æ’å›¾ã€‚åœ¨è¿™å¹…æ’å›¾ä¸­ï¼Œæˆ‘å°†åˆçº¦ä¸­çš„çŠ¶æ€å˜é‡ï¼ˆå­˜å‚¨åœ¨é“¾ä¸Šï¼‰æ¯”ä½œç¢§çªå…¬ä¸»ï¼Œä¸‰ç§ä¸åŒçš„è§’è‰²ä»£è¡¨ä¸åŒçš„å…³é”®å­—ã€‚

![WTF is pure and view in solidity?](https://images.mirror-media.xyz/publication-images/1B9kHsTYnDY_QURSWMmPb.png?height=1028&width=1758)

- `pure`ï¼Œä¸­æ–‡æ„æ€æ˜¯â€œçº¯â€ï¼Œè¿™é‡Œå¯ä»¥ç†è§£ä¸ºâ€çº¯æ‰“é…±æ²¹çš„â€ã€‚`pure` å‡½æ•°æ—¢ä¸èƒ½è¯»å–ä¹Ÿä¸èƒ½å†™å…¥é“¾ä¸Šçš„çŠ¶æ€å˜é‡ã€‚å°±åƒå°æ€ªä¸€æ ·ï¼Œçœ‹ä¸åˆ°ä¹Ÿæ‘¸ä¸åˆ°ç¢§çªå…¬ä¸»ã€‚

- `view`ï¼Œâ€œçœ‹â€ï¼Œè¿™é‡Œå¯ä»¥ç†è§£ä¸ºâ€œçœ‹å®¢â€ã€‚`view`å‡½æ•°èƒ½è¯»å–ä½†ä¹Ÿä¸èƒ½å†™å…¥çŠ¶æ€å˜é‡ã€‚ç±»ä¼¼é©¬é‡Œå¥¥ï¼Œèƒ½çœ‹åˆ°ç¢§çªå…¬ä¸»ï¼Œä½†ç»ˆç©¶æ˜¯çœ‹å®¢ï¼Œä¸èƒ½å…¥æ´æˆ¿ã€‚

- é `pure` æˆ– `view` çš„å‡½æ•°æ—¢å¯ä»¥è¯»å–ä¹Ÿå¯ä»¥å†™å…¥çŠ¶æ€å˜é‡ã€‚ç±»ä¼¼é©¬é‡Œå¥¥é‡Œçš„ `boss`ï¼Œå¯ä»¥å¯¹ç¢§çªå…¬ä¸»ä¸ºæ‰€æ¬²ä¸ºğŸ¶ã€‚

## ä»£ç 

### 1. pure å’Œ view

æˆ‘ä»¬åœ¨åˆçº¦é‡Œå®šä¹‰ä¸€ä¸ªçŠ¶æ€å˜é‡ `number`ï¼Œåˆå§‹åŒ–ä¸º 5ã€‚

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.4;
contract FunctionTypes{
    uint256 public number = 5;
}
```

å®šä¹‰ä¸€ä¸ª `add()` å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨ä¼šè®© `number` å¢åŠ  1ã€‚

```solidity
// é»˜è®¤
function add() external{
    number = number + 1;
}
```

å¦‚æœ `add()` å‡½æ•°è¢«æ ‡è®°ä¸º `pure`ï¼Œæ¯”å¦‚ `function add() external pure`ï¼Œå°±ä¼šæŠ¥é”™ã€‚å› ä¸º `pure` æ˜¯ä¸é…è¯»å–åˆçº¦é‡Œçš„çŠ¶æ€å˜é‡çš„ï¼Œæ›´ä¸é…æ”¹å†™ã€‚é‚£ `pure` å‡½æ•°èƒ½åšäº›ä»€ä¹ˆï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥ç»™å‡½æ•°ä¼ é€’ä¸€ä¸ªå‚æ•° `_number`ï¼Œç„¶åè®©ä»–è¿”å› `_number + 1`ï¼Œè¿™ä¸ªæ“ä½œä¸ä¼šè¯»å–æˆ–å†™å…¥çŠ¶æ€å˜é‡ã€‚

```solidity
// pure: çº¯çº¯ç‰›é©¬
function addPure(uint256 _number) external pure returns(uint256 new_number){
    new_number = _number + 1;
}
```

![3-3.png](./img/3-3.png)

å¦‚æœ `add()` å‡½æ•°è¢«æ ‡è®°ä¸º `view`ï¼Œæ¯”å¦‚ `function add() external view`ï¼Œä¹Ÿä¼šæŠ¥é”™ã€‚å› ä¸º `view` èƒ½è¯»å–ï¼Œä½†ä¸èƒ½å¤Ÿæ”¹å†™çŠ¶æ€å˜é‡ã€‚æˆ‘ä»¬å¯ä»¥ç¨å¾®æ”¹å†™ä¸‹å‡½æ•°ï¼Œè¯»å–ä½†æ˜¯ä¸æ”¹å†™ `number`ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å˜é‡ã€‚

```solidity
// view: çœ‹å®¢
function addView() external view returns(uint256 new_number) {
    new_number = number + 1;
}
```

![3-4.png](./img/3-4.png)

### 2. internal v.s. external

```solidity
// internal: å†…éƒ¨å‡½æ•°
function minus() internal {
    number = number - 1;
}

// åˆçº¦å†…çš„å‡½æ•°å¯ä»¥è°ƒç”¨å†…éƒ¨å‡½æ•°
function minusCall() external {
    minus();
}
```

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª `internal` çš„ `minus()` å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨ä½¿å¾— `number` å˜é‡å‡å°‘ 1ã€‚ç”±äº `internal` å‡½æ•°åªèƒ½ç”±åˆçº¦å†…éƒ¨è°ƒç”¨ï¼Œæˆ‘ä»¬å¿…é¡»å†å®šä¹‰ä¸€ä¸ª `external` çš„ `minusCall()` å‡½æ•°ï¼Œé€šè¿‡å®ƒé—´æ¥è°ƒç”¨å†…éƒ¨çš„ `minus()` å‡½æ•°ã€‚

![3-1.png](./img/3-1.png)

### 3. payable

```solidity
// payable: é€’é’±ï¼Œèƒ½ç»™åˆçº¦æ”¯ä»˜ethçš„å‡½æ•°
function minusPayable() external payable returns(uint256 balance) {
    minus();    
    balance = address(this).balance;
}
```

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª `external payable` çš„ `minusPayable()` å‡½æ•°ï¼Œé—´æ¥çš„è°ƒç”¨ `minus()`ï¼Œå¹¶ä¸”è¿”å›åˆçº¦é‡Œçš„ ETH ä½™é¢ï¼ˆ`this` å…³é”®å­—å¯ä»¥è®©æˆ‘ä»¬å¼•ç”¨åˆçº¦åœ°å€ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨ `minusPayable()` æ—¶å¾€åˆçº¦é‡Œè½¬å…¥1ä¸ª ETHã€‚

![mirror-image-1](https://images.mirror-media.xyz/publication-images/ETDPN8myq7jFfAL8CUAFt.png?height=148&width=588)

æˆ‘ä»¬å¯ä»¥åœ¨è¿”å›çš„ä¿¡æ¯ä¸­çœ‹åˆ°ï¼Œåˆçº¦çš„ä½™é¢å˜ä¸º 1 ETHã€‚

![mirror-image-2](https://images.mirror-media.xyz/publication-images/nGZ2pz0MvzgXuKrENJPYf.png?height=128&width=1130)

![3-2.png](./img/3-2.png)

## æ€»ç»“

åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä»‹ç»äº† `Solidity` ä¸­çš„å‡½æ•°ã€‚`pure` å’Œ `view` å…³é”®å­—æ¯”è¾ƒéš¾ç†è§£ï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­æ²¡å‡ºç°è¿‡ï¼š`view` å‡½æ•°å¯ä»¥è¯»å–çŠ¶æ€å˜é‡ï¼Œä½†ä¸èƒ½æ”¹å†™ï¼›`pure` å‡½æ•°æ—¢ä¸èƒ½è¯»å–ä¹Ÿä¸èƒ½æ”¹å†™çŠ¶æ€å˜é‡ã€‚
